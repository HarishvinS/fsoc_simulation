{% extends "base.html" %}

{% block title %}FSOC Link Optimization - Optimize Deployment{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3>
                    <i class="bi bi-gear"></i>
                    AI-Powered Deployment Optimization
                </h3>
            </div>
            <div class="card-body">
                <p class="text-secondary mb-4">
                    Get intelligent recommendations for optimal FSOC link deployment parameters based on your location, constraints, and expected environmental conditions.
                </p>
                
                <form method="POST" action="/optimize" id="optimizationForm">
                    <!-- Location Section -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <h4 class="text-primary mb-3">
                                <i class="bi bi-geo-alt"></i>
                                Link Locations
                            </h4>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0">
                                        <i class="bi bi-broadcast"></i>
                                        Transmitter Location
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="lat_tx" class="form-label">Latitude (°)</label>
                                                <input type="number" step="0.0001" class="form-control" id="lat_tx" name="lat_tx" required min="-90" max="90" value="37.7749">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="lon_tx" class="form-label">Longitude (°)</label>
                                                <input type="number" step="0.0001" class="form-control" id="lon_tx" name="lon_tx" required min="-180" max="180" value="-122.4194">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card border-success">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0">
                                        <i class="bi bi-reception-4"></i>
                                        Receiver Location
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="lat_rx" class="form-label">Latitude (°)</label>
                                                <input type="number" step="0.0001" class="form-control" id="lat_rx" name="lat_rx" required min="-90" max="90" value="37.7849">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="lon_rx" class="form-label">Longitude (°)</label>
                                                <input type="number" step="0.0001" class="form-control" id="lon_rx" name="lon_rx" required min="-180" max="180" value="-122.4094">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <!-- Expected Conditions -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <h4 class="text-primary mb-3">
                                <i class="bi bi-cloud-rain"></i>
                                Expected Environmental Conditions
                            </h4>
                            <p class="text-muted mb-3">Provide average or typical conditions for this location</p>
                        </div>
                        
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="avg_fog_density" class="form-label">
                                    <i class="bi bi-cloud-fog"></i>
                                    Avg. Fog Density (g/m³)
                                </label>
                                <input type="number" step="0.1" class="form-control" id="avg_fog_density" name="avg_fog_density" min="0" max="5" value="0.1">
                                <div class="form-text">Typical fog conditions</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="avg_rain_rate" class="form-label">
                                    <i class="bi bi-cloud-rain"></i>
                                    Avg. Rain Rate (mm/hr)
                                </label>
                                <input type="number" step="0.1" class="form-control" id="avg_rain_rate" name="avg_rain_rate" min="0" max="50" value="2.0">
                                <div class="form-text">Average precipitation</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="avg_surface_temp" class="form-label">
                                    <i class="bi bi-thermometer-sun"></i>
                                    Avg. Surface Temp (°C)
                                </label>
                                <input type="number" step="0.1" class="form-control" id="avg_surface_temp" name="avg_surface_temp" min="-20" max="60" value="25.0">
                                <div class="form-text">Typical surface heating</div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="mb-3">
                                <label for="avg_ambient_temp" class="form-label">
                                    <i class="bi bi-thermometer"></i>
                                    Avg. Ambient Temp (°C)
                                </label>
                                <input type="number" step="0.1" class="form-control" id="avg_ambient_temp" name="avg_ambient_temp" min="-30" max="50" value="20.0">
                                <div class="form-text">Average air temperature</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <!-- Constraints -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <h4 class="text-primary mb-3">
                                <i class="bi bi-sliders"></i>
                                Deployment Constraints
                            </h4>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="min_height" class="form-label">
                                    <i class="bi bi-arrow-down"></i>
                                    Minimum Height (m)
                                </label>
                                <input type="number" step="0.1" class="form-control" id="min_height" name="min_height" min="1" max="100" value="5">
                                <div class="form-text">Lowest allowable mounting height</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="max_height" class="form-label">
                                    <i class="bi bi-arrow-up"></i>
                                    Maximum Height (m)
                                </label>
                                <input type="number" step="0.1" class="form-control" id="max_height" name="max_height" min="10" max="1000" value="100">
                                <div class="form-text">Highest allowable mounting height</div>
                            </div>
                        </div>
                        
                        <div class="col-12">
                            <div class="mb-3">
                                <label class="form-label">
                                    <i class="bi bi-tools"></i>
                                    Available Materials
                                </label>
                                <div class="row g-2">
                                    <div class="col-md-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="available_materials" value="white_paint" id="material_white_paint" checked>
                                            <label class="form-check-label" for="material_white_paint">
                                                <i class="bi bi-circle-fill text-light"></i>
                                                White Paint
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="available_materials" value="black_paint" id="material_black_paint">
                                            <label class="form-check-label" for="material_black_paint">
                                                <i class="bi bi-circle-fill text-dark"></i>
                                                Black Paint
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="available_materials" value="aluminum" id="material_aluminum" checked>
                                            <label class="form-check-label" for="material_aluminum">
                                                <i class="bi bi-circle-fill text-secondary"></i>
                                                Aluminum
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="available_materials" value="steel" id="material_steel" checked>
                                            <label class="form-check-label" for="material_steel">
                                                <i class="bi bi-circle-fill text-muted"></i>
                                                Steel
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="available_materials" value="concrete" id="material_concrete">
                                            <label class="form-check-label" for="material_concrete">
                                                <i class="bi bi-circle-fill" style="color: #6c757d;"></i>
                                                Concrete
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="available_materials" value="wood" id="material_wood">
                                            <label class="form-check-label" for="material_wood">
                                                <i class="bi bi-circle-fill" style="color: #8b4513;"></i>
                                                Wood
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <!-- Performance Requirements -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <h4 class="text-primary mb-3">
                                <i class="bi bi-target"></i>
                                Performance Requirements
                            </h4>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="min_received_power_dbm" class="form-label">
                                    <i class="bi bi-reception-4"></i>
                                    Min. Received Power (dBm)
                                </label>
                                <input type="number" step="0.1" class="form-control" id="min_received_power_dbm" name="min_received_power_dbm" value="-30">
                                <div class="form-text">Minimum acceptable signal level</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="reliability_target" class="form-label">
                                    <i class="bi bi-shield-check"></i>
                                    Reliability Target
                                </label>
                                <select class="form-select" id="reliability_target" name="reliability_target">
                                    <option value="0.90">90% (Basic)</option>
                                    <option value="0.95">95% (Good)</option>
                                    <option value="0.99" selected>99% (High)</option>
                                    <option value="0.999">99.9% (Critical)</option>
                                </select>
                                <div class="form-text">Required link availability</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="d-flex gap-3 justify-content-end">
                        <button type="reset" class="btn btn-outline-secondary">
                            <i class="bi bi-arrow-clockwise"></i>
                            Reset Form
                        </button>
                        <button type="submit" class="btn btn-success" id="optimizeBtn">
                            <i class="bi bi-robot"></i>
                            Run AI Optimization
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('optimizationForm');
    const optimizeBtn = document.getElementById('optimizeBtn');
    
    form.addEventListener('submit', function() {
        optimizeBtn.innerHTML = '<span class="loading-spinner"></span> Running Optimization...';
        optimizeBtn.disabled = true;
    });
});
</script>
{% endblock %}